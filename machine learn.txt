Experiment 6 
Title: Write a program to Implement Low-Pass FIR filter for ECG. 
Program Code: 
fs = 500;                      
t = 0:1/fs:10;                
% Sampling frequency (Hz) 
 % Time vector for 10 seconds 
ecg = 1.2*sin(2*pi*1.7*t) + 0.5*sin(2*pi*60*t) + 0.1*randn(size(t));  % Simulated 
ECG + 60Hz noise 
fc = 40;                      
N = 51;                        
n = 0:N-1;                    
 % Cutoff frequency (Hz) 
% Filter order (odd number for symmetric FIR) 
 % Filter sample indices 
% Ideal impulse response of low-pass filter (sinc function) 
wc = 2*pi*fc/fs; 
h = sin(wc*(n - (N-1)/2)) ./ (pi*(n - (N-1)/2)); 
h((N-1)/2 + 1) = wc / pi;      
% Handle division by zero at center 
% Apply window (Hann window) 
w = hann(N)'; 
h = h .* w; 
% Normalize filter coefficients 
h = h / sum(h); 
% Filter ECG signal using convolution 
ecg_filtered = conv(ecg, h, 'same'); 
% Plot the results 
figure; 
plot(t, ecg, 'b'); hold on; 
plot(t, ecg_filtered, 'r'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
title('Low-Pass FIR Filtered ECG'); 
legend('Original ECG', 'Filtered ECG'); 
grid on; 
load ecg; 
fs = 360; 
order = 20; 
cutoff = 0.1; 
b = fir1(order, cutoff); 
y = filter(b, 1, ecg); 
plot(y); 
Output: 
Result: 
The expected output is verified and the objective of the experiment is achieved. 


Experiment 7 
Title: Write a program to implement FIR filter using Kaiser Window. 
Program Code: 
fs = 500; 
t = 0:1/fs:10; 
ecg = 1.2*sin(2*pi*1.5*t) + 0.6*sin(2*pi*60*t) + 0.1*randn(size(t)); 
fc = 40; 
wc = 2*pi*fc/fs; 
A = 60; 
if A > 50 
beta = 0.1102*(A - 8.7); 
elseif A >= 21 
beta = 0.5842*(A - 21)^0.4 + 0.07886*(A - 21); 
else 
beta = 0; 
end 
delta_f = 5; 
N = ceil((A - 8) / (2.285 * 2 * pi * delta_f / fs)); 
if mod(N,2)==0 
N = N + 1; 
end 
n = 0:N-1; 
alpha = (N - 1)/2; 
h = sin(wc*(n - alpha)) ./ (pi*(n - alpha)); 
h(alpha+1) = wc/pi; 
w = kaiser(N, beta)'; 
h = h .* w; 
h = h / sum(h); 
ecg_fir = conv(ecg, h, 'same'); 
plot(t, ecg, 'b'); hold on; 
plot(t, ecg_fir, 'r'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
title('FIR Filtered ECG using Kaiser Window'); 
legend('Original ECG','Filtered ECG'); 
grid on; 
Output: 
Result: 
The expected output is verified and the objective of the experiment is achieved. 


Experiment 8 
Title: Write a program to detect QRS complex and measure the heart rate of a given 
ECG signal. 
Program Code: 
% Complete MATLAB program for QRS detection and heart rate calculation 
clear; close all; clc; 
%% Parameters 
fs = 360;              
duration = 10;        
% Sampling frequency (Hz) 
 % Duration of signal in seconds 
t = 0:1/fs:duration;   % Time vector 
%% Generate synthetic ECG-like signal for testing 
% Base heart rate ~72 bpm (1.2 Hz) 
ecg_signal = 0.6*sin(2*pi*1.2*t); 
% Add some noise 
ecg_signal = ecg_signal + 0.05*randn(size(t)); 
%% Step 1: Bandpass filter (5-15 Hz) 
bpFilt = designfilt('bandpassiir','FilterOrder',2, ... 
'HalfPowerFrequency1',5,'HalfPowerFrequency2',15, ... 
'SampleRate',fs); 
filtered_ecg = filtfilt(bpFilt, ecg_signal); 
%% Step 2: Differentiate 
diff_ecg = diff(filtered_ecg); 
diff_ecg(end+1) = 0; % keep length same 
%% Step 3: Square the signal 
squared_ecg = diff_ecg .^ 2; 
%% Step 4: Moving window integration (150 ms window) 
window_size = round(0.15 * fs); 
integrated_ecg = conv(squared_ecg, ones(1,window_size)/window_size, 'same'); 
%% Step 5: Detect peaks on integrated signal 
min_distance = round(0.25 * fs); % Minimum distance between peaks (250 ms) 
threshold = mean(integrated_ecg); % Simple threshold 
[peaks, locs] = findpeaks(integrated_ecg, 'MinPeakDistance', min_distance, 
'MinPeakHeight', threshold); 
qrs_peaks = locs; 
%% Step 6: Calculate heart rate 
rr_intervals = diff(qrs_peaks) / fs; % RR intervals in seconds 
heart_rate = 60 ./ rr_intervals;      
% bpm 
%% Display results 
fprintf('Detected QRS peak indices:\n'); 
disp(qrs_peaks); 
fprintf('Instantaneous Heart Rates (bpm):\n'); 
disp(heart_rate); 
%% Step 7: Plot results 
figure; 
plot(t, ecg_signal, 'b'); 
hold on; 
plot(t(qrs_peaks), ecg_signal(qrs_peaks), 'ro', 'MarkerSize', 8, 'LineWidth', 2); 
xlabel('Time (s)'); 
ylabel('ECG Amplitude'); 
title('Synthetic ECG Signal with Detected QRS Complexes'); 
legend('ECG Signal', 'Detected QRS Peaks'); 
grid on; 
Output: 
In the command window 
Result: The expected output is verified and the objective of the experiment is achieved.


Experiment 9 
Title: . Write a program to improve the SNR using signal averaging technique. 
Program Code: 
clc; 
clear; 
num_trials = 100; 
signal_length = 500; 
fs = 1000; 
t = (0:signal_length-1)/fs; 
f = 5; 
true_signal = sin(2*pi*f*t); 
noisy_signals = zeros(num_trials, signal_length); 
for i = 1:num_trials 
noise = randn(1, signal_length); 
noisy_signals(i, :) = true_signal + noise; 
end 
averaged_signal = mean(noisy_signals, 1); 
figure; 
subplot(2, 1, 1); 
plot(t, noisy_signals(1, :), 'r'); 
hold on; 
plot(t, true_signal, 'k--'); 
title('Single Noisy Signal vs True Signal'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
legend('Noisy Signal', 'True Signal'); 
grid on; 
subplot(2, 1, 2); 
plot(t, averaged_signal, 'b'); 
hold on; 
plot(t, true_signal, 'k--'); 
title(['Averaged Signal (', num2str(num_trials), ' trials) vs True Signal']); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
legend('Averaged Signal', 'True Signal'); 
grid on; 
Output: 
Result: 
The expected output is verified and the objective of the experiment is achieved. 


Experiment 10 
Title: Write a program to obtain the DCT & IDCT of ECG signal 
Program code: 
clc; 
clear; 
fs = 360; 
t = 0:1/fs:1; 
ecg_signal = ecg(length(t))'; 
dct_signal = dct(ecg_signal); 
reconstructed_ecg = idct(dct_signal); 
figure; 
subplot(3,1,1); 
plot(t, ecg_signal); 
title('Original ECG Signal'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
subplot(3,1,2); 
stem(dct_signal, 'Marker', 'none'); 
title('DCT of ECG Signal'); 
xlabel('Coefficient Index'); 
ylabel('Amplitude'); 
subplot(3,1,3); 
plot(t, reconstructed_ecg); 
title('Reconstructed ECG Signal using IDCT'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
Output: 
Result: 
The expected output is verified and the objective of the experiment is achieved. 
